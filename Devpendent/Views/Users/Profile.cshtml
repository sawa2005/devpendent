@using System.Globalization;
@using Devpendent.Infrastructure.Extensions;
@model Devpendent.Areas.Identity.Data.DevpendentUser

@{
    ViewData["Title"] = "@" + Model.UserName + "'s Profile";
}

<div class="user-main-wrap mb-5">
    <div>
        <div class="user-profile-wrap mb-5">
            <img src="../media/users/@Model.Image" alt="@Model.UserName 's Profile Picture" />
            <div class="user-profile-text">
                <div>
                    <h1>@Html.DisplayFor(model => model.FirstName) @Html.DisplayFor(model => model.LastName)</h1>
                    <p>@@@Html.DisplayFor(model => model.UserName)</p>
                    <vc:ratings id="0" type="average" user-name="@Model.UserName" />
                </div>

                @if (Model.Specialties == null)
                {
                    <p class="my-3">No specialties added yet.</p>
                }
                else
                {
                    <p class="my-3">Specializes in @Html.DisplayFor(model => model.Specialties).</p>
                }
                <div>
                    @if (Model.Location != null)
                    {
                        <div class="d-flex align-items-center gap-2">
                            <svg xmlns="http://www.w3.org/2000/svg" width="14.523" height="17.461" viewBox="0 0 14.523 17.461">
                                <g id="Icon_feather-map-pin" data-name="Icon feather-map-pin" transform="translate(0.65 0.65)">
                                    <path d="M17.723,8.111c0,5.142-6.611,9.55-6.611,9.55S4.5,13.253,4.5,8.111a6.611,6.611,0,0,1,13.223,0Z" transform="translate(-4.5 -1.5)" fill="none" stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.3" />
                                    <path d="M17.908,12.7a2.2,2.2,0,1,1-2.2-2.2,2.2,2.2,0,0,1,2.2,2.2Z" transform="translate(-9.092 -6.092)" fill="none" stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.3" />
                                </g>
                            </svg>
                            <p>@Html.DisplayFor(model => model.Location)</p>
                        </div>
                    }

                    @if (Model.Website != null)
                    {
                        <div class="d-flex align-items-center gap-2">
                            <svg xmlns="http://www.w3.org/2000/svg" width="15.574" height="15.574" viewBox="0 0 15.574 15.574">
                                <g id="Icon_feather-globe" data-name="Icon feather-globe" transform="translate(-2.35 -2.35)">
                                    <path id="Path_27" data-name="Path 27" d="M17.274,10.137A7.137,7.137,0,1,1,10.137,3,7.137,7.137,0,0,1,17.274,10.137Z" fill="none" stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.3" />
                                    <path id="Path_28" data-name="Path 28" d="M3,18H17.274" transform="translate(0 -7.863)" fill="none" stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.3" />
                                    <path id="Path_29" data-name="Path 29" d="M14.855,3a10.92,10.92,0,0,1,2.855,7.137,10.92,10.92,0,0,1-2.855,7.137A10.92,10.92,0,0,1,12,10.137,10.92,10.92,0,0,1,14.855,3Z" transform="translate(-4.718)" fill="none" stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.3" />
                                </g>
                            </svg>
                            <a href="@Model.Website" target="_blank">@Model.Website</a>
                        </div>
                    }

                    <div class="d-flex align-items-center gap-2">
                        <svg xmlns="http://www.w3.org/2000/svg" width="14.792" height="13.826" viewBox="0 0 14.792 13.826">
                            <g transform="translate(0.65 0.65)">
                                <path d="M13.5,10.871l2.088,2.088L22.547,6" transform="translate(-9.324 -5.304)" fill="none" stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.3" />
                                <path d="M17.026,10.763v4.871a1.392,1.392,0,0,1-1.392,1.392H5.892A1.392,1.392,0,0,1,4.5,15.635V5.892A1.392,1.392,0,0,1,5.892,4.5h7.655" transform="translate(-4.5 -4.5)" fill="none" stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.3" />
                            </g>
                        </svg>
                        <p>@ViewBag.ProjectCount projects available</p>
                    </div>
                    <div class="d-flex align-items-center gap-2">
                        <svg xmlns="http://www.w3.org/2000/svg" width="14.523" height="15.992" viewBox="0 0 14.523 15.992">
                            <g data-name="Icon feather-calendar" transform="translate(0.65 0.65)">
                                <path d="M5.969,6H16.253a1.469,1.469,0,0,1,1.469,1.469V17.753a1.469,1.469,0,0,1-1.469,1.469H5.969A1.469,1.469,0,0,1,4.5,17.753V7.469A1.469,1.469,0,0,1,5.969,6Z" transform="translate(-4.5 -4.531)" fill="none" stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.3" />
                                <path d="M24,3V5.938" transform="translate(-14.451 -3)" fill="none" stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.3" />
                                <path d="M12,3V5.938" transform="translate(-8.327 -3)" fill="none" stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.3" />
                                <path d="M4.5,15H17.723" transform="translate(-4.5 -9.123)" fill="none" stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.3" />
                            </g>
                        </svg>
                        <p>
                            Member since @Model.RegisterDate.ToString("MMMM dd, yyyy", CultureInfo.CreateSpecificCulture("en-GB"))
                        </p>
                    </div>
                </div>
            </div>
        </div>
        <div class="user-bio">
            <h3>Developer biography</h3>
            
            @if (Model.Description == null)
            {
                <p>We do not know much about this developer yet but hopefully they will add a biography soon.</p>
            }
            else
            {
                <p>@Html.Raw(Model.Description)</p>
            }
            
        </div>
    </div>
    <div class="shortinfo">
        <h3>Contact me</h3>
        <p>@Html.DisplayFor(model => model.ContactText)</p>
        <div class="mt-4">
            @if (Model.PhoneNumber != null)
            {
                <div class="d-flex align-items-center gap-2 mb-3">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16.271" height="16.301" viewBox="0 0 16.271 16.301">
                        <path d="M18.138,14.23v2.258A1.505,1.505,0,0,1,16.5,17.994,14.9,14.9,0,0,1,10,15.683a14.678,14.678,0,0,1-4.516-4.516A14.9,14.9,0,0,1,3.174,4.641,1.505,1.505,0,0,1,4.672,3H6.93A1.505,1.505,0,0,1,8.435,4.295,9.665,9.665,0,0,0,8.962,6.41,1.505,1.505,0,0,1,8.623,8l-.956.956a12.043,12.043,0,0,0,4.516,4.516l.956-.956a1.505,1.505,0,0,1,1.588-.339,9.665,9.665,0,0,0,2.115.527,1.505,1.505,0,0,1,1.295,1.528Z" transform="translate(-2.517 -2.35)" fill="none" stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.3" />
                    </svg>
                    <p>@Html.DisplayFor(model => model.PhoneNumber)</p>
                </div>
            }
            <div class="d-flex align-items-center gap-2 mb-3">
                <svg xmlns="http://www.w3.org/2000/svg" width="16.784" height="13.3" viewBox="0 0 16.784 13.3">
                    <g transform="translate(-2.108 -5.35)">
                        <path d="M4.5,6h12A1.5,1.5,0,0,1,18,7.5v9A1.5,1.5,0,0,1,16.5,18H4.5A1.5,1.5,0,0,1,3,16.5v-9A1.5,1.5,0,0,1,4.5,6Z" fill="none" stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.3" />
                        <path d="M18,9l-7.5,4.5L3,9" transform="translate(0 -1.5)" fill="none" stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.3" />
                    </g>
                </svg>
                <p>@Html.DisplayFor(model => model.Email)</p>
            </div>
        </div>
        <a class="btn btn-clear mt-4" href="mailto:@Model.Email">
            Contact this developer
            <svg xmlns="http://www.w3.org/2000/svg" width="16.68" height="16.68" viewBox="0 0 16.68 16.68">
                <path d="M19.88,14.753a1.709,1.709,0,0,1-1.709,1.709H7.918L4.5,19.88V6.209A1.709,1.709,0,0,1,6.209,4.5H18.171A1.709,1.709,0,0,1,19.88,6.209Z" transform="translate(-3.85 -3.85)" fill="none" stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.3" />
            </svg>
        </a>
    </div>
</div>

<div>
    <h3>Current projects</h3>
    @if (Model.Projects.Count > 0)
    {
        <div class="project-wrap">
            @foreach (var item in Model.Projects)
            {
                <div class="project">
                    <a asp-controller="Projects" asp-action="Details" asp-route-id="@item.Id">
                        <div>
                            <div class="project-thumb-wrap" style="background-image: linear-gradient(rgba(0,0,0) 0%, rgba(0,0,0,0) 75%), url('/media/projects/@item.Image');">
                                <h3>@item.Title</h3>
                            </div>
                            <div class="project-text-wrap">
                                <div class="project-user-wrap">
                                    <img src="/media/users/@item.User.Image" class="project-pfp" alt="@item.User.UserName 's Profile Picture">
                                    <div>
                                        <h5>@item.User.FirstName @item.User.LastName</h5>
                                        <p>@@@item.User.UserName</p>
                                    </div>
                                </div>
                                <div class="mt-3 project-desc-wrap">
                                    @Html.Raw(item.Description.Truncate(40))
                                </div>
                                <div class="project-info-wrap">
                                    <div>
                                        <h4>Delivery Time</h4>
                                        <h3>@item.DeliveryTime</h3>
                                    </div>
                                    <div class="budget-wrap">
                                        <h4>Budget</h4>
                                        <h3>@item.Budget USD</h3>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </a>
                </div>
            }
        </div>

        <a asp-controller="Users" asp-action="Projects" asp-route-userName="@Model.UserName" class="d-block my-3 text-center">Browse all @@@Model.UserName's projects</a>
    }
    else
    {
        <p>Nothing here yet.</p>
    }

</div>

<div class="mt-5 jobs-wrap">
    <h3>Previous work experience</h3>
    @if (Model.Jobs.Count < 1)
    {
        <p>Nothing here yet.</p>
    }

    else
    {
        @foreach (var item in Model.Jobs)
        {
            <div class="job">
                <h4>@item.Title</h4>
                <h6>@item.StartDate.ToString("MMMM dd, yyyy", CultureInfo.CreateSpecificCulture("en-GB")) - @item.EndDate.ToString("MMMM dd, yyyy", CultureInfo.CreateSpecificCulture("en-GB"))</h6>
                <p>@item.Description</p>
            </div>
        }
    }
</div>

<div class="mt-4 educations-wrap">
    <h3>Education</h3>
    @if (Model.Educations.Count < 1)
    {
        <p>Nothing here yet.</p>
    }

    else
    {
        @foreach (var item in Model.Educations)
        {
            <div class="education">
                <h4>@item.Title - @item.UniversityName</h4>
                <h6>Graduated in @item.GraduationYear</h6>
            </div>
        }
    }
</div>

<div class="mt-5 reviews-wrap">
    <div>
        <h3>Reviews</h3>
        @if (ViewBag.ReviewCount == 1)
        {
            <p class="mb-0">1 review</p>
        }

        else
        {
            <p class="mb-0">@ViewBag.ReviewCount reviews</p>
        }
        <vc:ratings id="0" type="average" user-name="@Model.UserName" />

        @if (ViewBag.CreateReview != false)
        {
            <a asp-controller="Reviews" asp-action="Create" asp-route-userName="@Model.UserName" class="btn btn-clear my-2">Leave a Review</a>
        }
    </div>

    @if (Model.Reviews.Count < 1)
    {
        <p>Nothing here yet.</p>
    }

    else
    {
        var count = 0;

        @foreach (var item in Model.Reviews.OrderByDescending(r => r.Date))
        {
            @if (count < 6)
            {
                <div class="review">
                    <h4>@item.Title</h4>
                    <div>
                        <h5>@@@item.Author</h5>
                        <vc:ratings id="@item.Id" type="single" user-name="@Model.UserName" />
                        <p>@item.Text</p>
                    </div>
                </div>
            }
             count++;
        }
    }

    <div class="m-3 category-link">
        <a asp-controller="Reviews" asp-action="Index" asp-route-userName="@Model.UserName">View all</a>
    </div>
</div>
